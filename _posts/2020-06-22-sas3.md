---
toc: true
layout: post
description: I finish this project by plotting various charts to summarise the data obtained in the previous two parts.
categories: [python, data science]
title: Stop and Sarch, Part III, Data Analysis
---
## Total number of stops and searches

### Grouped by ethnicity
I start by plotting the total number of stops and searches (since May 2017 because that is the earliest data of the dataset), grouped by ethnicity.

![]({{ site.baseurl }}/images/sas3_sas_eth.png) 

From this chart, a simplistic conlusion would be that white people are searched significantly more than other ethnicities, so there is no racism in the system. This is clearly bad reasoning, as we need to account for the underlying population.

### Including population
Population data is taken from [here](https://www.ethnicity-facts-figures.service.gov.uk/uk-population-by-ethnicity/national-and-regional-populations/population-of-england-and-wales/latest#:~:text=the%20total%20population%20of%20England%20and%20Wales%20was%2056.1%20million,White%20ethnic%20group%20(4.4%25)). I use this data to produce the following chart. Note that I grouped the various numbers together in the same way I grouped ethnicities together in producing the ethnicities column.

 ![]({{ site.baseurl }}/images/sas3_pop_eth.png)

Now things look bad. There is clearly a discrepancy between the population and the number of stop and searches.

To visualise this discrepancy more clearly, I decided to create a [Sankey diagram](http://www.sankey-diagrams.com/) using [Plotly](https://plotly.com/python/sankey-diagram/).

 ![]({{ site.baseurl }}/images/sas3_sankey_eth.png)

The diagram makes the discrepancy quite plain to see. Black people are stopped disproportionately more than other ethnic groups. There is evidently a big problem here. 

However, and unfortunately, this diagram does not tell us where exactly the problem is. Is the problem with the police or is there a deeper problem? Are the police racist for stopping black people more often, or, is this a reflection of crime rates and the underlying social issues?

Some people would look at the above diagram and wonder how this is not conclusive evidence of police racism. To illustrate the idea, consider the following two charts: 

![]({{ site.baseurl }}/images/sas3_sankey_gen.png)

![]({{ site.baseurl }}/images/sas3_sankey_age.png)

## Code
Here I provide sample of the code used to produce the charts.

Below is the code to produce the first bar chart.

```python
colours_255 = [(66, 133, 244,255), (234, 67, 53,255), (251, 188, 5,255), (52, 168, 83, 255)]

colours = [ tuple(n / 255 for n in colour) for colour in colours_255]

plt.figure
sns.barplot(x = sas_ethnicity.index, y = sas_ethnicity,
           order = ['White', 'Black', 'Asian', 'Other'],
           palette = colours)
plt.grid(True, axis = 'y')
plt.title('Stop and Searches since May 2017, by Ethnicity')
plt.xlabel('Ethnicity')
plt.ylabel('Number of Stop and Searches')
plt.tight_layout()
plt.savefig('sas3_sas_eth.png')
```

Here is the code to produce Sankey diagrams.

```python
# create function that plots Sankey diagram given appropriate dataframe

def create_sankey(df, title):
    len = df.shape[0]
    
    fig = go.Figure(data=[go.Sankey(
    node = dict(
      pad = 15,
      thickness = 20,
      line = dict(color = "black", width = 0.5),
      label = ['Proportion of Population'] + list(df.index) + ['Proportion of Stop and Searches'],
      color = "blue"
    ),
    link = dict(
      source = [0]*len + list(range(1,len+1)),
      target = list(range(1,len+1)) + [len+1]*len,
      value = df.iloc[:,0].append(df.iloc[:,1])
    ))])

    fig.update_layout(title_text=title, font_size=15)
    fig.show()

# create dataframe containing population and stop and search data by ethnicity
sas_eth_pop = pd.DataFrame({'population': population, 'sas': sas_ethnicity, }, index = sas_ethnicity.index)
sas_eth_pop = sas_eth_pop.loc[['White', 'Black', 'Asian', 'Other']]
sas_eth_pop.sas = sas_eth_pop.sas/sas_eth_pop.sas.sum()*100


# create sankey diagram
create_sankey(sas_eth_pop, 'Stop and Searches by Ethnicity')
```
