<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Increasing the resolution of an image using an SRGAN</h1><p class="page-description">I have my first experience of image processing, and of using a pre-trained network.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-08-28T00:00:00-05:00" itemprop="datePublished">
        Aug 28, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      2 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#python">python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#neural network">neural network</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#introduction">Introduction</a></li>
<li class="toc-entry toc-h2"><a href="#steps-taken">Steps taken</a></li>
<li class="toc-entry toc-h2"><a href="#results">Results</a>
<ul>
<li class="toc-entry toc-h3"><a href="#example-1">Example 1</a></li>
<li class="toc-entry toc-h3"><a href="#example-2">Example 2</a></li>
<li class="toc-entry toc-h3"><a href="#example-3">Example 3</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#limits">Limits</a></li>
</ul><!---
## Other posts in series












































































* [Investigating Credit Card Fraud, Part VI, Summary and Lessons from Kaggle](/blog/python/data%20science/2020/06/25/creditcard6.html)















* [Investigating Credit Card Fraud, Part V, Final Models](/blog/python/data%20science/2020/05/30/creditcard5.html)



* [Investigating Credit Card Fraud, Part IV, `n_estimators`](/blog/python/data%20science/2020/05/29/creditcard4.html)







* [Investigating Credit Card Fraud, Part III, Handmade Model](/blog/python/data%20science/2020/05/19/creditcard3.html)



* [Investigating Credit Card Fraud, Part II, Removing data](/blog/python/data%20science/2020/05/16/creditcard2.html)





* [Investigating Credit Card Fraud, Part I, First Models](/blog/python/data%20science/2020/05/14/creditcard1.html)










-->

<h2 id="introduction">
<a class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h2>
<p>I wanted to print out an image for a friend, and I wanted to first crop the image to only include a relatively small part of the photo (namely, the individuals in the photo. The original photo was 90% scenary).  However, after the cropping, the image became too small and would have been pixelated when printed.  I thought that a neural network ought to be able to solve this problem, because it could be trained on a manually created dataset (just take a bunch of images and use these as the <em>outputs</em>, then reduce the quality of these images to create the <em>inputs</em>). I decided to Google around to see what already had been done, and I found out about SRGANs.  At my current level of knowledge, I cannot understand the details of the architecture, so for now, my aim was just to see if I could use a pre-trained network to achieve my goal. After a bit more searching, I found <a href="https://github.com/HasnainRaz/Fast-SRGAN">this Github repo</a>.</p>

<h2 id="steps-taken">
<a class="anchor" href="#steps-taken" aria-hidden="true"><span class="octicon octicon-link"></span></a>Steps taken</h2>
<ul>
  <li>Create a new directory and environment.</li>
  <li>Download the github repo.</li>
  <li>Install the requirements.</li>
  <li>Create a directory <code class="highlighter-rouge">inputs</code> for input images, and folder <code class="highlighter-rouge">outputs</code> for where the output images will go.</li>
  <li>Add images to the inputs directory.</li>
  <li>Run the command `python infer.py –image_dir ‘inputs’ –output_dir ‘outputs’</li>
</ul>

<h2 id="results">
<a class="anchor" href="#results" aria-hidden="true"><span class="octicon octicon-link"></span></a>Results</h2>
<p>Below are samples of the images, comparing before and after applying the neural network.</p>

<h3 id="example-1">
<a class="anchor" href="#example-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example 1</h3>
<p><img src="/blog/images/srgan1_1.png" alt="image"></p>

<h3 id="example-2">
<a class="anchor" href="#example-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example 2</h3>
<p><img src="/blog/images/srgan1_2.png" alt="image"></p>

<h3 id="example-3">
<a class="anchor" href="#example-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example 3</h3>
<p><img src="/blog/images/srgan1_3.png" alt="image"></p>

<p>This is amazing! This feels like magic to me.</p>

<h2 id="limits">
<a class="anchor" href="#limits" aria-hidden="true"><span class="octicon octicon-link"></span></a>Limits</h2>
<p>I tried applying this to blurry images, expecting it to make the images less blurry. This did not happen:</p>

<p><img src="/blog/images/srgan1_4.png" alt="image"></p>

<p>This reveals how limited my understanding is! After thinking and googling a bit, I think the issue is that resolution and blurriness/sharpness are two separate issues. Previously, I just lumped them together as ‘reasons an image can look bad’. After a bit more searching, it seems I might learn about anti-blurring / sharpening in the FastAI course that I am doing, so that is something to look forward to.</p>

<p>Finally, I hope I will soon be at at stage where I can understand these intricate architectures, and be able to train my own cutting edge neural networks.</p>


  </div><a class="u-url" href="/blog/python/neural%20network/2020/08/28/srgan1.html" hidden></a>
</article>