<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Neural Networks, Part II, First MNIST model</h1><p class="page-description">I use the vanilla network from the first part on the MNIST data, achieving an accuracy of 94.9%.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-07-14T00:00:00-05:00" itemprop="datePublished">
        Jul 14, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      1 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#python">python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#data science">data science</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#neural network">neural network</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#other-posts-in-series">Other posts in series</a></li>
<li class="toc-entry toc-h2"><a href="#first-mnist-model">First MNIST model</a></li>
<li class="toc-entry toc-h2"><a href="#next-steps">Next steps</a></li>
</ul><h2 id="other-posts-in-series">
<a class="anchor" href="#other-posts-in-series" aria-hidden="true"><span class="octicon octicon-link"></span></a>Other posts in series</h2>

<ul>
  <li><a href="/blog/python/data%20science/neural%20network/2020/07/09/neural1.html">Neural Networks, Part I, Basic network from scratch</a></li>
</ul>

<h2 id="first-mnist-model">
<a class="anchor" href="#first-mnist-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>First MNIST model</h2>
<p>Using the neural network class from Part I, I train a neural network on the MNIST dataset.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data_train</span><span class="p">,</span> <span class="n">data_valid</span><span class="p">,</span> <span class="n">data_test</span> <span class="o">=</span> <span class="n">mnist_loader</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">train</span><span class="p">():</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">neural1</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">"Accuracy on testing data: {net.accuracy(data_test)}"</span><span class="p">)</span>
    <span class="n">net</span><span class="o">.</span><span class="n">sgd</span><span class="p">(</span><span class="n">data_train</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">"Accuracy on testing data: {net.accuracy(data_test)}"</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'network1.config'</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></div>

<p>The results of running this were:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Accuracy on testing data: 0.08475
Epoch 0 starting.   Epoch 0 done. Accuracy is 0.902
Epoch 1 starting.   Epoch 1 done. Accuracy is 0.912
Epoch 2 starting.   Epoch 2 done. Accuracy is 0.931
Epoch 3 starting.   Epoch 3 done. Accuracy is 0.939
Epoch 4 starting.   Epoch 4 done. Accuracy is 0.930
Epoch 5 starting.   Epoch 5 done. Accuracy is 0.943
Epoch 6 starting.   Epoch 6 done. Accuracy is 0.943
Epoch 7 starting.   Epoch 7 done. Accuracy is 0.948
Epoch 8 starting.   Epoch 8 done. Accuracy is 0.948
Epoch 9 starting.   Epoch 9 done. Accuracy is 0.950
Accuracy on testing data: 0.9496333333333333
</code></pre></div></div>

<h2 id="next-steps">
<a class="anchor" href="#next-steps" aria-hidden="true"><span class="octicon octicon-link"></span></a>Next steps</h2>
<p>I will continue to work through <a href="http://neuralnetworksanddeeplearning.com/chap1.html">Nielsen’s online book</a>, learning more about neural networks.</p>

  </div><a class="u-url" href="/blog/python/data%20science/neural%20network/2020/07/14/neural2.html" hidden></a>
</article>