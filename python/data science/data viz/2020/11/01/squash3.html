<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Squash rankings, Part III, All hail Bokeh!</h1><p class="page-description">Bokeh is amazing! I learnt about it earlier this week and I want to illustrate its prowess by remaking plots from Part II series using Bokeh.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-11-01T00:00:00-05:00" itemprop="datePublished">
        Nov 1, 2020
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      3 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#python">python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#data science">data science</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#data viz">data viz</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#other-posts-in-series">Other posts in series</a></li>
<li class="toc-entry toc-h2"><a href="#introduction">Introduction</a></li>
<li class="toc-entry toc-h2"><a href="#bokeh-charts">Bokeh charts</a></li>
<li class="toc-entry toc-h2"><a href="#conclusion">Conclusion</a></li>
<li class="toc-entry toc-h2"><a href="#code">Code</a></li>
</ul><body>
<h2 id="other-posts-in-series">
<a class="anchor" href="#other-posts-in-series" aria-hidden="true"><span class="octicon octicon-link"></span></a>Other posts in series</h2>

<ul>
  <li>
    <p><a href="/blog/python/data%20science/2020/09/28/squash2.html">Squash rankings, Part II, dimension reduction and clustering</a></p>
  </li>
  <li>
    <p><a href="/blog/python/scraping/2020/09/17/squash1.html">Squash rankings, Part I, Scraping wikipedia and data analysis</a></p>
  </li>
</ul>

<h2 id="introduction">
<a class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h2>
<p>One of my mentors at the Faculty Fellowship, Sania Jevtic, recommended I try using Bokeh to plot various charts I was making. I tried it and without too much effort I managed to get it to work. It is AMAZING! The interactivity you get from it is fantastic and allows for much easier understanding of your data and richer presentation of your data. I will try to illustrate by redrawing some of the charts from Part II of this series.</p>

<p>I will be re-making the three charts below:</p>

<p><img src="/blog/images/squash2_malecluster.png" alt="image"></p>

<p>Recall that the colours are clusters made by doing k-mean clustering on the original dataset, not doing clustering on each of the dimensionally-reduced datasets.</p>

<h2 id="bokeh-charts">
<a class="anchor" href="#bokeh-charts" aria-hidden="true"><span class="octicon octicon-link"></span></a>Bokeh charts</h2>


  
  
    
      <meta charset="utf-8">
      <title>Bokeh Plot</title>
      
      
        
          
        
        
          
        <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-2.2.3.min.js" integrity="sha384-T2yuo9Oe71Cz/I4X9Ac5+gpEa5a8PpJCDlqKYO0CfAuEszu1JrXLl8YugMqYe3sM" crossorigin="anonymous"></script>
        <script type="text/javascript">
            Bokeh.set_log_level("info");
        </script>
        
      
      
    
  
  
  
  
    
      
        
          
          
            
              <div class="bk-root" id="a1121850-5f93-4e82-a97f-6e47190ce637" data-root-id="3676"></div>
            
          
        
      
      
        <script type="application/json" id="3968">
          {"c67160e1-6f6b-4b1d-b68f-5b2a1204fa65":{"roots":{"references":[{"attributes":{"background_fill_color":"white","below":[{"id":"3687"}],"center":[{"id":"3690"},{"id":"3694"}],"left":[{"id":"3691"}],"renderers":[{"id":"3706"}],"title":{"id":"3677"},"toolbar":{"id":"3699"},"x_range":{"id":"3679"},"x_scale":{"id":"3683"},"y_range":{"id":"3681"},"y_scale":{"id":"3685"}},"id":"3676","subtype":"Figure","type":"Plot"},{"attributes":{"bottom_units":"screen","fill_alpha":0.5,"fill_color":"lightgrey","left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","top_units":"screen"},"id":"3698","type":"BoxAnnotation"},{"attributes":{},"id":"3712","type":"BasicTickFormatter"},{"attributes":{"overlay":{"id":"3698"}},"id":"3695","type":"BoxZoomTool"},{"attributes":{"text":"PCA of Male Squash Player Rankings"},"id":"3677","type":"Title"},{"attributes":{},"id":"3714","type":"Selection"},{"attributes":{},"id":"3713","type":"UnionRenderers"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"field":"clusters","transform":{"id":"3675"}},"line_alpha":{"value":0.1},"line_color":{"field":"clusters","transform":{"id":"3675"}},"x":{"field":"x"},"y":{"field":"y"}},"id":"3705","type":"Scatter"},{"attributes":{"fill_color":{"field":"clusters","transform":{"id":"3675"}},"line_color":{"field":"clusters","transform":{"id":"3675"}},"x":{"field":"x"},"y":{"field":"y"}},"id":"3704","type":"Scatter"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","tools":[{"id":"3695"},{"id":"3696"},{"id":"3697"}]},"id":"3699","type":"Toolbar"},{"attributes":{},"id":"3710","type":"BasicTickFormatter"},{"attributes":{},"id":"3683","type":"LinearScale"},{"attributes":{"source":{"id":"3674"}},"id":"3707","type":"CDSView"},{"attributes":{"axis":{"id":"3687"},"grid_line_color":null,"ticker":null},"id":"3690","type":"Grid"},{"attributes":{},"id":"3681","type":"DataRange1d"},{"attributes":{"formatter":{"id":"3710"},"ticker":{"id":"3692"}},"id":"3691","type":"LinearAxis"},{"attributes":{"callback":null,"tooltips":[["Player","@players"],["Best rank","@best_rank"],["Years in Top 10","@years_in_top10"],["Earliest year","@earliest_year"]]},"id":"3696","type":"HoverTool"},{"attributes":{},"id":"3688","type":"BasicTicker"},{"attributes":{},"id":"3685","type":"LinearScale"},{"attributes":{},"id":"3692","type":"BasicTicker"},{"attributes":{"data":{"best_rank":[1,1,1,1,1,1,1,2,2,1,1,1,4,4,1,1,3,1,2,5,6,6,5,2,5,4,4,1,5,7,7,4,3,7,4,5,7,5,5,3,7,8,9,9,8,9,9,10,10,10,10],"clusters":["0","2","0","0","1","1","1","0","0","1","1","1","0","0","1","1","0","1","2","0","0","0","2","0","2","2","2","0","2","2","0","0","0","0","0","0","2","1","0","2","0","0","2","0","2","2","0","0","2","2","2"],"earliest_year":["1996","2016","1996","1997","2010","2006","2003","1997","1996","2004","2000","2004","1998","2001","2001","2005","2002","2003","2015","1998","1996","1998","2016","1999","2017","2012","2014","2002","2015","2019","1999","2000","1996","1996","1996","1996","2013","2008","1996","2014","2001","1996","2010","1999","2007","2015","2000","1998","2011","2018","2012"],"players":[" Peter Nicol"," Ali Farag"," Jansher Khan"," Jonathon Power"," Mohamed El Shorbagy"," Ramy Ashour"," Gr\u00e9gory Gaultier"," Ahmed Barada"," Rodney Eyles"," Nick Matthew"," David Palmer"," Amr Shabana"," Paul Johnson"," Stewart Boswell"," Thierry Lincou"," James Willstrop"," Anthony Ricketts"," Karim Darwish"," Karim Abdel Gawad"," Martin Heath"," Del Harris"," Dan Jenson"," Marwan El Shorbagy"," John White"," Paul Coll"," Omar Mosaad"," Tarek Momen"," Lee Beachill"," Miguel \u00c1ngel Rodr\u00edguez"," Diego Elias"," Stefan Casteleyn"," David Evans"," Simon Parke"," Craig Rowland"," Chris Walker"," Brett Martin"," Borja Gol\u00e1n"," Peter Barker"," Anthony Hill"," Simon R\u00f6sner"," Ong Beng Hee"," Mark Chaloner"," Laurens Jan Anjema"," Alex Gough"," Wael El Hindi"," Mathieu Castagnet"," Paul Price"," Derek Ryan"," Mohd Azlan Iskandar"," Mohamed Abouelghar"," Daryl Selby"],"x":{"__ndarray__":"6UhB5GHoHcAojcaOrzkvQAhxhMmXlSrAe75Q4b9tG8AOASrFpo4oQBvkZLzOjx1ALxPLk31nHUAO6vfU9CwmwA8dG7gapirANUJq09W8HEDL7xCNDB/Mv9kilmgKnxJAZ7dMcoAMJcBxKm3pQrIcwK+F3k9H1ti/bVEc7PReHkAFSjlwJ3wKwIkKaXqWYglAwSV0hpFqLkDVFAB8vh4lwNv1fy+daizAekavFo91KMCPNeur0lkvQC7pIBNVpxDAg0B0LyI4MEBDvhjjXWMlQDyycOWA+yxA80dosim/CMB9dG6Vt/EtQMqhZFhrUTFAVMkVDBGUJcAXKWWiX9kgwOOp5jH5FCfAEdjQzrMCLsAQkl77jRcswFtSSztCLSzANiv/PppvI0BdnBIyaMAbQASICBpRAynAyL3SGnkvLUCfgB2hbRgZwPQpCtAPfiTAT7qcoqb1EkBvfrMPI8YjwMBjYNfb1wFAfiUyVJYyKUCWMlEfxOIgwOW6QkXFLSjAlrTPt6K4GEABKc47kQQwQKY50gXm1SBA","dtype":"float64","order":"little","shape":[51]},"y":{"__ndarray__":"ofkUQYeBIUBnMV8nQcTZP9//q5jorf8/AeCpTCB1HUCrWn9nxbkaQL0y7FHO6B9A7P3MIRjMKEDdyNBCLez/P+WHSiogrPI/u0qRU0DFJUCKi1+Y3qUhQG5vrl/kFyBApE74wNj/0b/jcelCScv5v+evDqxlbx1AbDmye2ewIEDifEks4yrpP6rt5HqkFR1Ap1Mg3rsh7z9O88gFDv7vv3BcyoUXOQLA8cI233iqC8CTCwiwp1ADwEcLHJHHBBJAa+Ccz+LmDMBR2fUuU9/+v74Cx6Zmr+K/YizlZZJAAUBUDXYkYdQGwIamBxPlZxvA+sqaOz9iEcBo6ULruDz/v9xojz1/e/0/r+2UtszCD8Bb0+s+NDj3v2EVHNrVsf+/w607OxOuFMAkxvCIYf3xPw418P9/0eu/17JwpFwO2D+axfpGHzQHwBeZ7CHfgP6/ZJqKdM/+HMC+auMmlMMTwMOUF/9N7xHAx4A60xjIG8Dxz99+BbsUwPxBg3QmCBrA8wFFIOlFIMDFDvgl5gYiwMckJHT6Ux3A","dtype":"float64","order":"little","shape":[51]},"years_in_top10":[10,4,3,9,10,11,15,4,3,14,11,11,3,2,10,11,4,10,6,3,2,1,4,7,3,3,5,5,3,1,1,2,5,1,2,2,2,7,3,6,3,3,1,2,3,2,2,1,1,1,2]},"selected":{"id":"3714"},"selection_policy":{"id":"3713"}},"id":"3674","type":"ColumnDataSource"},{"attributes":{},"id":"3679","type":"DataRange1d"},{"attributes":{"formatter":{"id":"3712"},"ticker":{"id":"3688"}},"id":"3687","type":"LinearAxis"},{"attributes":{},"id":"3697","type":"ResetTool"},{"attributes":{"data_source":{"id":"3674"},"glyph":{"id":"3704"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"3705"},"selection_glyph":null,"view":{"id":"3707"}},"id":"3706","type":"GlyphRenderer"},{"attributes":{"factors":["0","1","2"],"palette":["#1f77b4","#ff7f0e","#2ca02c"]},"id":"3675","type":"CategoricalColorMapper"},{"attributes":{"axis":{"id":"3691"},"dimension":1,"grid_line_color":null,"ticker":null},"id":"3694","type":"Grid"}],"root_ids":["3676"]},"title":"Bokeh Application","version":"2.2.3"}}
        </script>
        <script type="text/javascript">
          (function() {
            var fn = function() {
              Bokeh.safely(function() {
                (function(root) {
                  function embed_document(root) {
                    
                  var docs_json = document.getElementById('3968').textContent;
                  var render_items = [{"docid":"c67160e1-6f6b-4b1d-b68f-5b2a1204fa65","root_ids":["3676"],"roots":{"3676":"a1121850-5f93-4e82-a97f-6e47190ce637"}}];
                  root.Bokeh.embed.embed_items(docs_json, render_items);
                
                  }
                  if (root.Bokeh !== undefined) {
                    embed_document(root);
                  } else {
                    var attempts = 0;
                    var timer = setInterval(function(root) {
                      if (root.Bokeh !== undefined) {
                        clearInterval(timer);
                        embed_document(root);
                      } else {
                        attempts++;
                        if (attempts > 100) {
                          clearInterval(timer);
                          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                        }
                      }
                    }, 10, root)
                  }
                })(window);
              });
            };
            if (document.readyState != "loading") fn();
            else document.addEventListener("DOMContentLoaded", fn);
          })();
        </script>
    
  
  



  
  
    
      <meta charset="utf-8">
      <title>Bokeh Plot</title>
      
      
        
          
        
        
          
        <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-2.2.3.min.js" integrity="sha384-T2yuo9Oe71Cz/I4X9Ac5+gpEa5a8PpJCDlqKYO0CfAuEszu1JrXLl8YugMqYe3sM" crossorigin="anonymous"></script>
        <script type="text/javascript">
            Bokeh.set_log_level("info");
        </script>
        
      
      
    
  
  
  
  
    
      
        
          
          
            
              <div class="bk-root" id="bcf7546e-220d-461c-b866-c8bf1b1deab6" data-root-id="3381"></div>
            
          
        
      
      
        <script type="application/json" id="3665">
          {"a027ea3a-ca4e-4258-936c-ac9559330638":{"roots":{"references":[{"attributes":{"background_fill_color":"white","below":[{"id":"3392"}],"center":[{"id":"3395"},{"id":"3399"}],"left":[{"id":"3396"}],"renderers":[{"id":"3411"}],"title":{"id":"3382"},"toolbar":{"id":"3404"},"x_range":{"id":"3384"},"x_scale":{"id":"3388"},"y_range":{"id":"3386"},"y_scale":{"id":"3390"}},"id":"3381","subtype":"Figure","type":"Plot"},{"attributes":{"data_source":{"id":"3379"},"glyph":{"id":"3409"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"3410"},"selection_glyph":null,"view":{"id":"3412"}},"id":"3411","type":"GlyphRenderer"},{"attributes":{},"id":"3402","type":"ResetTool"},{"attributes":{},"id":"3388","type":"LinearScale"},{"attributes":{},"id":"3390","type":"LinearScale"},{"attributes":{"fill_color":{"field":"clusters","transform":{"id":"3380"}},"line_color":{"field":"clusters","transform":{"id":"3380"}},"x":{"field":"x"},"y":{"field":"y"}},"id":"3409","type":"Scatter"},{"attributes":{"callback":null,"tooltips":[["Player","@players"],["Best rank","@best_rank"],["Years in Top 10","@years_in_top10"],["Earliest year","@earliest_year"]]},"id":"3401","type":"HoverTool"},{"attributes":{},"id":"3397","type":"BasicTicker"},{"attributes":{},"id":"3393","type":"BasicTicker"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"field":"clusters","transform":{"id":"3380"}},"line_alpha":{"value":0.1},"line_color":{"field":"clusters","transform":{"id":"3380"}},"x":{"field":"x"},"y":{"field":"y"}},"id":"3410","type":"Scatter"},{"attributes":{"formatter":{"id":"3415"},"ticker":{"id":"3397"}},"id":"3396","type":"LinearAxis"},{"attributes":{"formatter":{"id":"3417"},"ticker":{"id":"3393"}},"id":"3392","type":"LinearAxis"},{"attributes":{},"id":"3418","type":"UnionRenderers"},{"attributes":{"text":"tSNE of Male Squash Player Rankings"},"id":"3382","type":"Title"},{"attributes":{},"id":"3419","type":"Selection"},{"attributes":{"overlay":{"id":"3403"}},"id":"3400","type":"BoxZoomTool"},{"attributes":{"axis":{"id":"3396"},"dimension":1,"grid_line_color":null,"ticker":null},"id":"3399","type":"Grid"},{"attributes":{"axis":{"id":"3392"},"grid_line_color":null,"ticker":null},"id":"3395","type":"Grid"},{"attributes":{"data":{"best_rank":[1,1,1,1,1,1,1,2,2,1,1,1,4,4,1,1,3,1,2,5,6,6,5,2,5,4,4,1,5,7,7,4,3,7,4,5,7,5,5,3,7,8,9,9,8,9,9,10,10,10,10],"clusters":["0","2","0","0","1","1","1","0","0","1","1","1","0","0","1","1","0","1","2","0","0","0","2","0","2","2","2","0","2","2","0","0","0","0","0","0","2","1","0","2","0","0","2","0","2","2","0","0","2","2","2"],"earliest_year":["1996","2016","1996","1997","2010","2006","2003","1997","1996","2004","2000","2004","1998","2001","2001","2005","2002","2003","2015","1998","1996","1998","2016","1999","2017","2012","2014","2002","2015","2019","1999","2000","1996","1996","1996","1996","2013","2008","1996","2014","2001","1996","2010","1999","2007","2015","2000","1998","2011","2018","2012"],"players":[" Peter Nicol"," Ali Farag"," Jansher Khan"," Jonathon Power"," Mohamed El Shorbagy"," Ramy Ashour"," Gr\u00e9gory Gaultier"," Ahmed Barada"," Rodney Eyles"," Nick Matthew"," David Palmer"," Amr Shabana"," Paul Johnson"," Stewart Boswell"," Thierry Lincou"," James Willstrop"," Anthony Ricketts"," Karim Darwish"," Karim Abdel Gawad"," Martin Heath"," Del Harris"," Dan Jenson"," Marwan El Shorbagy"," John White"," Paul Coll"," Omar Mosaad"," Tarek Momen"," Lee Beachill"," Miguel \u00c1ngel Rodr\u00edguez"," Diego Elias"," Stefan Casteleyn"," David Evans"," Simon Parke"," Craig Rowland"," Chris Walker"," Brett Martin"," Borja Gol\u00e1n"," Peter Barker"," Anthony Hill"," Simon R\u00f6sner"," Ong Beng Hee"," Mark Chaloner"," Laurens Jan Anjema"," Alex Gough"," Wael El Hindi"," Mathieu Castagnet"," Paul Price"," Derek Ryan"," Mohd Azlan Iskandar"," Mohamed Abouelghar"," Daryl Selby"],"x":{"__ndarray__":"A0Agw7mNwEIkWZbBINwWwwpQ2MLE1OfC8YKmwiN27MHR+IDBYyS6wtgOBMOai+LCdYctwm+7UcKSivnCG4zNwiW598I1bu3CvDvGQs3aV8J7XKrCcRujwtVc9EKegQbDlMkFQ9Q+GUNf2eJCjzAAw1cRAENEeBRDhsGjwtozK8JiQirCT66vwvNrccLCBYrCImYkQzPfFEMod2HCvBHMQtonVcIOiXrC+Y9PQ9oSkMKh1VRDhuUrQ1uqgcK0gKbC6MtEQ2rZJkM5Sj9D","dtype":"float32","order":"little","shape":[51]},"y":{"__ndarray__":"ARc5wtM3bsJgsRZDH/oqwkn6BsMVnevCSRHjwl8jCkOeFQxD0tzWwhqNoMIenczC+ob8QrEz3UKbIJDCAObqwvGuT8GW27bCB3qTwhc8AENlRhhD/2oKQw2kh8ICvArCDwl+wjKj2MIF9qXCLfLAwSaEnsIm5HPCO+X9QqHLu0IsUTlD1oMjQ9sCK0OtnDFDW53LwtDi9sIl+zdDVweuwi56o0ILV0hCt6zPwhZpdkIcE+fC6Myown3vikItEYdCIUPbwj9skcKE2sTC","dtype":"float32","order":"little","shape":[51]},"years_in_top10":[10,4,3,9,10,11,15,4,3,14,11,11,3,2,10,11,4,10,6,3,2,1,4,7,3,3,5,5,3,1,1,2,5,1,2,2,2,7,3,6,3,3,1,2,3,2,2,1,1,1,2]},"selected":{"id":"3419"},"selection_policy":{"id":"3418"}},"id":"3379","type":"ColumnDataSource"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","tools":[{"id":"3400"},{"id":"3401"},{"id":"3402"}]},"id":"3404","type":"Toolbar"},{"attributes":{"source":{"id":"3379"}},"id":"3412","type":"CDSView"},{"attributes":{},"id":"3415","type":"BasicTickFormatter"},{"attributes":{},"id":"3384","type":"DataRange1d"},{"attributes":{},"id":"3417","type":"BasicTickFormatter"},{"attributes":{"bottom_units":"screen","fill_alpha":0.5,"fill_color":"lightgrey","left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","top_units":"screen"},"id":"3403","type":"BoxAnnotation"},{"attributes":{"factors":["0","1","2"],"palette":["#1f77b4","#ff7f0e","#2ca02c"]},"id":"3380","type":"CategoricalColorMapper"},{"attributes":{},"id":"3386","type":"DataRange1d"}],"root_ids":["3381"]},"title":"Bokeh Application","version":"2.2.3"}}
        </script>
        <script type="text/javascript">
          (function() {
            var fn = function() {
              Bokeh.safely(function() {
                (function(root) {
                  function embed_document(root) {
                    
                  var docs_json = document.getElementById('3665').textContent;
                  var render_items = [{"docid":"a027ea3a-ca4e-4258-936c-ac9559330638","root_ids":["3381"],"roots":{"3381":"bcf7546e-220d-461c-b866-c8bf1b1deab6"}}];
                  root.Bokeh.embed.embed_items(docs_json, render_items);
                
                  }
                  if (root.Bokeh !== undefined) {
                    embed_document(root);
                  } else {
                    var attempts = 0;
                    var timer = setInterval(function(root) {
                      if (root.Bokeh !== undefined) {
                        clearInterval(timer);
                        embed_document(root);
                      } else {
                        attempts++;
                        if (attempts > 100) {
                          clearInterval(timer);
                          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                        }
                      }
                    }, 10, root)
                  }
                })(window);
              });
            };
            if (document.readyState != "loading") fn();
            else document.addEventListener("DOMContentLoaded", fn);
          })();
        </script>
    
  
  



  
  
    
      <meta charset="utf-8">
      <title>Bokeh Plot</title>
      
      
        
          
        
        
          
        <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-2.2.3.min.js" integrity="sha384-T2yuo9Oe71Cz/I4X9Ac5+gpEa5a8PpJCDlqKYO0CfAuEszu1JrXLl8YugMqYe3sM" crossorigin="anonymous"></script>
        <script type="text/javascript">
            Bokeh.set_log_level("info");
        </script>
        
      
      
    
  
  
  
  
    
      
        
          
          
            
              <div class="bk-root" id="77dbe8d8-934a-4568-938e-5fd1ff971c0c" data-root-id="3094"></div>
            
          
        
      
      
        <script type="application/json" id="3370">
          {"6ecdfff2-0dec-4bda-b5d9-aa2a2108e600":{"roots":{"references":[{"attributes":{"background_fill_color":"white","below":[{"id":"3105"}],"center":[{"id":"3108"},{"id":"3112"}],"left":[{"id":"3109"}],"renderers":[{"id":"3124"}],"title":{"id":"3095"},"toolbar":{"id":"3117"},"x_range":{"id":"3097"},"x_scale":{"id":"3101"},"y_range":{"id":"3099"},"y_scale":{"id":"3103"}},"id":"3094","subtype":"Figure","type":"Plot"},{"attributes":{"data":{"best_rank":[1,1,1,1,1,1,1,2,2,1,1,1,4,4,1,1,3,1,2,5,6,6,5,2,5,4,4,1,5,7,7,4,3,7,4,5,7,5,5,3,7,8,9,9,8,9,9,10,10,10,10],"clusters":["0","2","0","0","1","1","1","0","0","1","1","1","0","0","1","1","0","1","2","0","0","0","2","0","2","2","2","0","2","2","0","0","0","0","0","0","2","1","0","2","0","0","2","0","2","2","0","0","2","2","2"],"earliest_year":["1996","2016","1996","1997","2010","2006","2003","1997","1996","2004","2000","2004","1998","2001","2001","2005","2002","2003","2015","1998","1996","1998","2016","1999","2017","2012","2014","2002","2015","2019","1999","2000","1996","1996","1996","1996","2013","2008","1996","2014","2001","1996","2010","1999","2007","2015","2000","1998","2011","2018","2012"],"players":[" Peter Nicol"," Ali Farag"," Jansher Khan"," Jonathon Power"," Mohamed El Shorbagy"," Ramy Ashour"," Gr\u00e9gory Gaultier"," Ahmed Barada"," Rodney Eyles"," Nick Matthew"," David Palmer"," Amr Shabana"," Paul Johnson"," Stewart Boswell"," Thierry Lincou"," James Willstrop"," Anthony Ricketts"," Karim Darwish"," Karim Abdel Gawad"," Martin Heath"," Del Harris"," Dan Jenson"," Marwan El Shorbagy"," John White"," Paul Coll"," Omar Mosaad"," Tarek Momen"," Lee Beachill"," Miguel \u00c1ngel Rodr\u00edguez"," Diego Elias"," Stefan Casteleyn"," David Evans"," Simon Parke"," Craig Rowland"," Chris Walker"," Brett Martin"," Borja Gol\u00e1n"," Peter Barker"," Anthony Hill"," Simon R\u00f6sner"," Ong Beng Hee"," Mark Chaloner"," Laurens Jan Anjema"," Alex Gough"," Wael El Hindi"," Mathieu Castagnet"," Paul Price"," Derek Ryan"," Mohd Azlan Iskandar"," Mohamed Abouelghar"," Daryl Selby"],"x":{"__ndarray__":"GLQIQcz3QkCSxxtB6B8GQccG4EBGyeNAxJ/9QOyNF0HgGhpB00P4QG0w9kAOKuxAFyUQQUSECkG12/9ACLXtQDC6AEF59/BAyAU/QKp2DUENexFBuV8LQRiLUkDFNv9AoG9CQDgXhUAoaGFAVCEBQRw2WUBqW1tAC64HQQoHB0F3KRVBTRcNQS83GEHvrhNBbaKLQOOzq0CUZQlB5hdjQIhJ/EAjpv5AkcKeQKmQ+UAqc6pAY/6HQKQnAEG28QNBhqqTQIsEd0Aa+5JA","dtype":"float32","order":"little","shape":[51]},"y":{"__ndarray__":"kzI6PqVWgEBAXaO/q1MVP9pCJkDfQA1AnwfxP5QVYr/DpLC/oMoBQN61iT9XYPQ/NMCPvz2TLr9LLJI/fKYWQKlzJL5WHMs/p/6FQHqyrr8gnQfAURrbv8lne0AYIAc/i4xkQMjJaUDGV4xAuf0wPtOae0A6VltAvF3Tv91whL9x7M6/gdQRwPwgCcAPwe+/BmCJQIxSX0BNcA/AXwZlQGJDh79nA/u//UCJQOzC0b/58IJAmqd9QE8qwb+aUvW/XamNQP/VgUC0hYBA","dtype":"float32","order":"little","shape":[51]},"years_in_top10":[10,4,3,9,10,11,15,4,3,14,11,11,3,2,10,11,4,10,6,3,2,1,4,7,3,3,5,5,3,1,1,2,5,1,2,2,2,7,3,6,3,3,1,2,3,2,2,1,1,1,2]},"selected":{"id":"3132"},"selection_policy":{"id":"3131"}},"id":"3092","type":"ColumnDataSource"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"field":"clusters","transform":{"id":"3093"}},"line_alpha":{"value":0.1},"line_color":{"field":"clusters","transform":{"id":"3093"}},"x":{"field":"x"},"y":{"field":"y"}},"id":"3123","type":"Scatter"},{"attributes":{"data_source":{"id":"3092"},"glyph":{"id":"3122"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"3123"},"selection_glyph":null,"view":{"id":"3125"}},"id":"3124","type":"GlyphRenderer"},{"attributes":{},"id":"3110","type":"BasicTicker"},{"attributes":{},"id":"3099","type":"DataRange1d"},{"attributes":{},"id":"3131","type":"UnionRenderers"},{"attributes":{},"id":"3115","type":"ResetTool"},{"attributes":{},"id":"3128","type":"BasicTickFormatter"},{"attributes":{},"id":"3130","type":"BasicTickFormatter"},{"attributes":{"text":"UMAP of Male Squash Player Rankings"},"id":"3095","type":"Title"},{"attributes":{},"id":"3103","type":"LinearScale"},{"attributes":{"formatter":{"id":"3128"},"ticker":{"id":"3110"}},"id":"3109","type":"LinearAxis"},{"attributes":{},"id":"3106","type":"BasicTicker"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","tools":[{"id":"3113"},{"id":"3114"},{"id":"3115"}]},"id":"3117","type":"Toolbar"},{"attributes":{},"id":"3097","type":"DataRange1d"},{"attributes":{},"id":"3101","type":"LinearScale"},{"attributes":{"axis":{"id":"3105"},"grid_line_color":null,"ticker":null},"id":"3108","type":"Grid"},{"attributes":{"overlay":{"id":"3116"}},"id":"3113","type":"BoxZoomTool"},{"attributes":{"formatter":{"id":"3130"},"ticker":{"id":"3106"}},"id":"3105","type":"LinearAxis"},{"attributes":{"bottom_units":"screen","fill_alpha":0.5,"fill_color":"lightgrey","left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","top_units":"screen"},"id":"3116","type":"BoxAnnotation"},{"attributes":{"source":{"id":"3092"}},"id":"3125","type":"CDSView"},{"attributes":{},"id":"3132","type":"Selection"},{"attributes":{"axis":{"id":"3109"},"dimension":1,"grid_line_color":null,"ticker":null},"id":"3112","type":"Grid"},{"attributes":{"factors":["0","1","2"],"palette":["#1f77b4","#ff7f0e","#2ca02c"]},"id":"3093","type":"CategoricalColorMapper"},{"attributes":{"callback":null,"tooltips":[["Player","@players"],["Best rank","@best_rank"],["Years in Top 10","@years_in_top10"],["Earliest year","@earliest_year"]]},"id":"3114","type":"HoverTool"},{"attributes":{"fill_color":{"field":"clusters","transform":{"id":"3093"}},"line_color":{"field":"clusters","transform":{"id":"3093"}},"x":{"field":"x"},"y":{"field":"y"}},"id":"3122","type":"Scatter"}],"root_ids":["3094"]},"title":"Bokeh Application","version":"2.2.3"}}
        </script>
        <script type="text/javascript">
          (function() {
            var fn = function() {
              Bokeh.safely(function() {
                (function(root) {
                  function embed_document(root) {
                    
                  var docs_json = document.getElementById('3370').textContent;
                  var render_items = [{"docid":"6ecdfff2-0dec-4bda-b5d9-aa2a2108e600","root_ids":["3094"],"roots":{"3094":"77dbe8d8-934a-4568-938e-5fd1ff971c0c"}}];
                  root.Bokeh.embed.embed_items(docs_json, render_items);
                
                  }
                  if (root.Bokeh !== undefined) {
                    embed_document(root);
                  } else {
                    var attempts = 0;
                    var timer = setInterval(function(root) {
                      if (root.Bokeh !== undefined) {
                        clearInterval(timer);
                        embed_document(root);
                      } else {
                        attempts++;
                        if (attempts > 100) {
                          clearInterval(timer);
                          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                        }
                      }
                    }, 10, root)
                  }
                })(window);
              });
            };
            if (document.readyState != "loading") fn();
            else document.addEventListener("DOMContentLoaded", fn);
          })();
        </script>
    
  
  


<p>So whatâ€™s so amazing about these? They look basically the same. The big advantage is in their interactivity! Try hovering your mouse over the points. What happens?</p>

<p>Cool, right! I canâ€™t stop being amazed at this. It makes the chart so much more informative and greatly aids in data exploration. For example, I can now just hover over the anomalous orange dot to find out what is going on: it is Peter Barker who has had a long successful career like the other orange dots, but has never actually reached the top few spots in the world rankings like the green dots. Another example is that I can understand some of the nuanced structure in the charts and find sub-clusters. For example, in the PCA diagram, the four points that are the highest in the green cluster form a sub-cluster of the players Ali Farag, Karim Abdel Gawad, Tarek Momen and Simon Rosner, who are excellent players who are consistently in the Top 5, but not legendary. (Ali Farag is an exception to this - he will undoubtedly join the orange cluster but his career is too short at the moment to join the cluster of elite players).</p>

<h2 id="conclusion">
<a class="anchor" href="#conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion</h2>
<p>Bokeh is amazing! This is what I managed to do after less than an hour of Googling around and adapting examples. If you look at the documentation, there is a whole load of other things that are possible, e.g. different kinds of interactivity.</p>

<p>I highly recommend you try using it.</p>

<h2 id="code">
<a class="anchor" href="#code" aria-hidden="true"><span class="octicon octicon-link"></span></a>Code</h2>
<p>Below is a sample of the code to illustrate how to create the Bokeh plots above.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># import packages
</span><span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">TSNE</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>

<span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">output_notebook</span><span class="p">,</span> <span class="n">show</span><span class="p">,</span> <span class="n">save</span><span class="p">,</span> <span class="n">ColumnDataSource</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">HoverTool</span><span class="p">,</span> <span class="n">CategoricalColorMapper</span>
<span class="kn">from</span> <span class="nn">bokeh.palettes</span> <span class="kn">import</span> <span class="n">d3</span>
<span class="kn">from</span> <span class="nn">bokeh.transform</span> <span class="kn">import</span> <span class="n">factor_cmap</span>
<span class="n">output_notebook</span><span class="p">()</span>

<span class="c1"># use tsne to do dimension reduction
</span><span class="n">tsne_model</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">perplexity</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">male_tsne</span> <span class="o">=</span> <span class="n">tsne_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">players_m</span><span class="p">)</span>

<span class="c1"># use kmeans on original dataset to determine clusters
</span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">players_m</span><span class="p">)</span>

<span class="c1"># create the bokeh plot
</span><span class="n">source</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">male_tsne</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">male_tsne</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">clusters</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="s">'{i}'</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">],</span>
        <span class="n">players</span><span class="o">=</span><span class="n">players_m</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
        <span class="n">best_rank</span><span class="o">=</span><span class="n">players_m</span><span class="o">.</span><span class="n">best_rank</span><span class="p">,</span>
        <span class="n">years_in_top10</span><span class="o">=</span><span class="n">players_m</span><span class="o">.</span><span class="n">years_in_top10</span><span class="p">,</span>
        <span class="n">earliest_year</span><span class="o">=</span><span class="n">players_m</span><span class="o">.</span><span class="n">earliest_year</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">palette</span> <span class="o">=</span> <span class="n">d3</span><span class="p">[</span><span class="s">'Category10'</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
<span class="n">color_map</span> <span class="o">=</span> <span class="n">CategoricalColorMapper</span><span class="p">(</span><span class="n">factors</span><span class="o">=</span><span class="p">[</span><span class="n">f</span><span class="s">'{i}'</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span>
                                   <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">)</span>

<span class="n">TOOLS</span><span class="o">=</span><span class="s">"box_zoom,hover,reset"</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"PCA of Male Squash Player Rankings"</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="n">TOOLS</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">background_fill_color</span> <span class="o">=</span> <span class="s">"white"</span>
<span class="n">p</span><span class="o">.</span><span class="n">xgrid</span><span class="o">.</span><span class="n">grid_line_color</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">p</span><span class="o">.</span><span class="n">ygrid</span><span class="o">.</span><span class="n">grid_line_color</span> <span class="o">=</span> <span class="bp">None</span>

<span class="n">p</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'x'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'y'</span><span class="p">,</span>
          <span class="n">color</span><span class="o">=</span><span class="p">{</span><span class="s">'field'</span><span class="p">:</span> <span class="s">'clusters'</span><span class="p">,</span> <span class="s">'transform'</span><span class="p">:</span> <span class="n">color_map</span><span class="p">},</span>
          <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>

<span class="n">hover</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">HoverTool</span><span class="p">))</span>
<span class="n">hover</span><span class="o">.</span><span class="n">tooltips</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s">"Player"</span><span class="p">,</span> <span class="s">"@players"</span><span class="p">),</span>
    <span class="p">(</span><span class="s">"Best rank"</span><span class="p">,</span> <span class="s">"@best_rank"</span><span class="p">),</span>
    <span class="p">(</span><span class="s">"Years in Top 10"</span><span class="p">,</span> <span class="s">"@years_in_top10"</span><span class="p">),</span>
    <span class="p">(</span><span class="s">"Earliest year"</span><span class="p">,</span> <span class="s">"@earliest_year"</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">save</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">'squash3_malepca.html'</span><span class="p">)</span>
</code></pre></div></div>
</body>
  </div><a class="u-url" href="/blog/python/data%20science/data%20viz/2020/11/01/squash3.html" hidden></a>
</article>